<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <title>Article List</title>
    <link
      rel="stylesheet"
      href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css"
    />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC"
      crossorigin="anonymous"
    />
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
      crossorigin="anonymous"
    ></script>
    <script
      src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js"
      integrity="sha384-IQsoLXl5PILFhosVNubq5LC7Qb9DXgDA9i+tQ8Zj3iwWAwPtgFTxbJ8NT4GN1R8p"
      crossorigin="anonymous"
    ></script>
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.min.js"
      integrity="sha384-cVKIPhGWiC2Al4u+LWgxfKTRIcfu0JTxR+EQDz/bgldoEyl4H0zUF0QKbrJ0EcQF"
      crossorigin="anonymous"
    ></script>
    <style>
      .myDIV1 {
        display: none;
      }
      .myDIV2 {
        display: none;
      }
      .myDIV3 {
        display: none;
      }
      .hide {
        display: block;
      }  
      .hide1 {
        display: block;
      }  
      .hide3 {
        display: block;
      }  
      .box-user:hover {
        background-color: #e9ecef;
   }
    </style>
  </head>
  <body>
    <div style="width: 100%">
      <nav class="navbar navbar-expand-lg navbar-light bg-light">
        <div class="container-fluid">
          <a class="navbar-brand" href="#">Article List</a>
          <button
            class="navbar-toggler"
            type="button"
            data-bs-toggle="collapse"
            data-bs-target="#navbarNavDropdown"
            aria-controls="navbarNavDropdown"
            aria-expanded="false"
            aria-label="Toggle navigation"
          >
            <span class="navbar-toggler-icon"></span>
          </button>
          <div class="collapse navbar-collapse" id="navbarNavDropdown">
            <ul class="navbar-nav">
              <li class="nav-item" style="padding-left:20px ;padding-right: 20px;">
                <a class="nav-link active" aria-current="page" href="#">Home</a>
              </li>
              <li class="IMG1 nav-item" style="padding-left:20px ;padding-right: 20px;">
                <!-- <a class="nav-link" href="/articles/createform"
                  >Create New Article</a
                > -->
              
                <p class="nav-link active" style="cursor: pointer;">
                  <a href="/articles/" style="text-decoration: none;color: #332d2d;">Articles</a>
                 
                </p>
               
              </li>
              <li class="IMG2 nav-item" style="padding-left:20px ;padding-right: 20px;">
                <p class="nav-link active" style="cursor: pointer;">
                  <a href="/articles/categories/" style="text-decoration: none;color: #332d2d;">Show category</a>
                 
                </p>
              </li>
              <li class="IMG3 nav-item" style="padding-left:20px ;padding-right: 20px;">
                <p class="nav-link active" style="cursor: pointer;">
                  <a  href="/articles/userlist" style="text-decoration: none; color: black;">User</a>
                  <div class="myDIV3" style=" position: absolute; top: 60px; left: 410px;z-index: 100; border: 1px solid #e9ecef;background-color: white;width: 150px; border-radius: 5px; height: 100px;">
                    
                  
                  </div>
                </p>
              </li>
             
            </ul>
          </div>
        </div>
      </nav>
    </div>
    <div class="box" style="height: 100%; width: 700px; display: flex;justify-content: center; align-items: center;margin-top: 15px;">
      <form class="sbox" action="/articles/search" method="get" style="width: 100%;height: 100%; display: flex;justify-content: center;align-items: center;">
      <input class="stext" type="text" name="q" placeholder="Tìm kiếm bài viết..." style="width: 90%; height: 30%;border-radius: 20px; outline: none;padding-left: 10px;border: 1px solid #e9ecef;font-weight: 300;font-size: bold;">
      <a class="sbutton" type="submit" href="javascript:void(0);" style="margin-left: 5px; color: #e9ecef;">
      <i class="fa fa-search" ></i>
      </a>
      </form>
      
        <div class="box-user" style="margin-left: 15px; width: 150px; height: 50px;display: flex; justify-content: center;align-items: center; padding-left:10px;padding-right: 10px;border: 1px solid #e9ecef;; "> <a href="/articles/createform" style="text-decoration: none;color: #332d2d;">Add articles</a></div>
        
      </div>
      <% if (!user) { %>
        <!-- Hiển thị nút đăng ký và đăng nhập khi chưa đăng nhập -->
      <div style="margin-bottom: 10px;"><button style="padding:10px;"> <a href="/registerform" style="text-decoration: none;">Đăng ký</a></button>
        <button style="padding:10px;">    <a href="/loginform" style="text-decoration: none;">Đăng nhập</a></button></div>  
        <% } else { %>
          <!-- Hiển thị thông tin người dùng và nút logout khi đã đăng nhập -->
          <div style="display: flex; background-color: white; height: 100px; justify-content: space-around;">
          <h1 style="color: black;">Article List</h1>
          
          <div class="IMG" style="display: flex; align-items: center; justify-content: center; cursor: pointer;">
            <div class="box-user" style="display: flex; justify-content: center;margin-right:15px ;"> <p><%= user.name %></p></div> 
          <img src="<%= user.image %>" alt="User Image"  style="max-width: 100px; max-height: 100px;border-radius: 50%;cursor: pointer;" onclick="myFunction()">
    
          <div class="myDIV" style=" position: absolute; top: 80px; right: 10px;z-index: 100; border: 1px solid #e9ecef;background-color: white;width: 150px; border-radius: 5px; height: 167px;">
         
          <div class="box-user" style="display: flex; justify-content: center;"> <p><%= user.email %></p></div> 
            <form id="deleteUserForm"  class="box-user" action="/articles/user/deletepersonuser" method="POST" style="margin-bottom: 10px;">
           <input type="hidden" name="userId" value="<%= user._id %>">
            <button type="submit" style="width: 140px; height: 50px; background-color: transparent; border: none;">Delete Account</button>
           </form>
           <div  class="box-user" style="display: flex; justify-content: center;align-items: center; padding-bottom: 5px;height: 50px;">   <a href="/logout" style="text-decoration: none;">Đăng xuất <i class="fa fa-sign-out" ></i></a>  </div> 
            </div>
          </div>
          
          </div>
          <% } %>
    <% if (articles.length === 0) { %>
    <p>No articles found.</p>
    <% } else { %>
    <ul style="display: flex; margin-top: 20px">
      <% articles.forEach((article)=> { %>
      <li
        style="list-style: none; height: auto; width: 250px; margin-right: 20px"
      >
        <img
          class="IMGNew"
          src="<%= article.imageUrl %>"
          alt="Article Image"
          style="height: 170px; width: 100%; cursor: pointer"
        />
        <a
          class="title1"
          style="
            text-decoration: none;
            cursor: pointer;
            color: #332d2d;
            font-size: 20px;
            margin-top: 10px;
          "
          href="/articles/user/find/<%= article._id %>"
        >
          <%= article.title %></a
        >
        <p style="cursor: pointer">Author: <%= article.author %></p>
        <div style="display: flex; align-items: center">
          <a
            style="text-decoration: none; margin-right: 5px"
            href="/articles/updateform/<%= article._id %>"
            ><i class="fa fa-edit"></i
          ></a>
          <form action="/articles/delete/<%= article._id %>" method="POST">
            <button
              type="submit"
              style="outline: none; border: none; background-color: transparent"
            >
              <i class="fa fa-trash"></i>
            </button>
          </form>
        </div>
      </li>
      <% }); %>
    </ul>
    <% } %>
   
   
    <script>
      document.addEventListener("DOMContentLoaded", function () {
        const imgElement = document.querySelector(".IMG1");
        const myDivElement = document.querySelector(".myDIV1");
        const imgElement2 = document.querySelector(".IMG2");
        const myDivElement2 = document.querySelector(".myDIV2");
        const imgElement3 = document.querySelector(".IMG3");
        const myDivElement3 = document.querySelector(".myDIV3");
        imgElement.addEventListener("mouseover", function () {
          myDivElement.classList.add("hide");
        });
    
        imgElement.addEventListener("mouseout", function () {
          myDivElement.classList.remove("hide");
        });
        imgElement2.addEventListener("mouseover", function () {
          myDivElement2.classList.add("hide1");
        });
    
        imgElement2.addEventListener("mouseout", function () {
          myDivElement2.classList.remove("hide1");
        });
        imgElement3.addEventListener("mouseover", function () {
          myDivElement3.classList.add("hide3");
        });
    
        imgElement3.addEventListener("mouseout", function () {
          myDivElement3.classList.remove("hide3");
        });
      });
    </script>
  </body>
  <script>
    const deleteUserForm = document.getElementById("deleteUserForm");

    deleteUserForm.addEventListener("submit", function (event) {
      event.preventDefault();

      const confirmation = confirm(
        "Are you sure you want to delete your account?"
      );

      if (confirmation) {
        deleteUserForm.submit();
      }
    });
  </script>
</html>
